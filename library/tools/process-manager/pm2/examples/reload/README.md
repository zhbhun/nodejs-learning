# 热重载

pm2 reload 时会先发送给集群的某个进程 SIGINT 信号，通知其处理资源释放。例如：express 关闭连接（`server.close`），停止接受新的连接，但已连接的请求不受影响，然后等待已连接请求完成处理，最终触发 `server.close` 回调，关闭进程。如果部分连接的请求处理时间过长，pm2 会根据 `--kill-timeout` 时间进行超时强制关闭进程，这时会导致已连接请求处理失败，所以要合理设置超时时间。此外，在实际测试中发现 express 调用 `server.close` 后仍然可能接收到新的连接，如果该连接的请求能在  `--kill-timeout` 设置的超时前处理完成，那么仍然可以正常响应，否则 pm2 会将其切换到另外一个进程处理。关闭某个进程后，然后按上面的逻辑一次一个个关闭进程。

问题：pm2 这种在关闭连接后还会接受请求处理的方式，可能导致部分请求处理时间过长。